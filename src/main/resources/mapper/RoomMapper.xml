<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ffyc.myfirstboot.dao.RoomDao">
    <insert id="addRoom" parameterType="room">
        insert into room(number, buildingID, height, operator, operate_time)
        values (#{number}, #{buildingID}, #{height}, #{operator}, now())
    </insert>
    <update id="updateRoom" parameterType="room">
        update room
        set number =#{number},
            buildingID=#{buildingID},
            height=#{height},
            operator=#{operator},
            operate_time=now()
            where id=#{id}
    </update>
    <update id="deleteRoom">
        update room set state=0
        where id = #{roomId}
    </update>
    <select id="getRoomById" resultType="Room">
        SELECT *
        FROM room
        WHERE id = #{roomId} and room.state=1
    </select>
    <select id="getRoomList" parameterType="room" resultType="Room">
        SELECT id,number,find_building_name(buildingID) buildingName,height,find_manage_account(operator)
        operatorAccount,operate_time FROM room r where r.state=1
            <if test="buildingID!=''&amp; buildingID!=null">
                buildingID=#{buildingID}
            </if>
            <if test="height!='' &amp; height!=null">
                and height=#{height}
            </if>
            <if test="number!=''">
                and number=#{number}
            </if>
    </select>
    <select id="getFloorsByBuildingID" resultType="java.lang.Integer">
        select height from building where id = #{buildingID}
    </select>
    <select id="getregiestRoom" resultType="com.ffyc.myfirstboot.model.Room">
        SELECT * FROM room WHERE buildingID=#{buildingID} AND height=#{height} and room.state=1
    </select>
</mapper>