<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ffyc.myfirstboot.dao.ExpressDao">
    <insert id="save">
           INSERT INTO express(studentID,TYPE,CODE,arriveTime,TIME)VALUES(#{id},#{type},#{code},#{arriveTime},now())
    </insert>
    <insert id="frontSubmit">
        insert into express(studentID,type,code,tip,time,arriveTime)values(#{studentID},#{type},#{code},#{tip},now(),#{arriveTime})
    </insert>
    <update id="updateSave" parameterType="Express">
        update express
        set code=#{code},type=#{type},state=#{state},operator=#{operatePerson},operate_time=now()
        where id=#{id}
    </update>
    <select id="updateExpress" resultType="Express">
        select * from express where id=#{id}
    </select>
    <delete id="delete">
        delete  from express where id=#{id};
    </delete>


    <select id="expressList" resultType="Express" parameterType="Express">
        SELECT e.id,s.NAME student_name,b.name building_name,r.number,s.sex,phone,e.type,e.time,e.code,e.tip,e.arriveTime
        FROM express e
        LEFT JOIN student s ON e.studentID=s.id
        LEFT JOIN building b ON s.buildingID=b.id
        LEFT JOIN room r ON s.roomID=r.id
        where e.state=0
       <if test="phone!=''">
            and s.phone=#{phone}
        </if>
        <if test="arriveTime!=null">
            and Date(e.arriveTime)=#{arriveTime}
        </if>
        <if test="buildingName!=''">
            and b.name=#{buildingName}
        </if>
        <if test="type!=''">
            and e.type=#{type}
        </if>
    </select>
    <select id="searchID" resultType="java.lang.Integer">
        select id from student where sno=#{sno}
    </select>
    <select id="searchOver" resultType="com.ffyc.myfirstboot.model.Express">
        SELECT e.id,s.NAME student_name,b.name building_name,r.number,s.sex,phone,e.type,e.time,e.code,e.arriveTime
        FROM express e
        LEFT JOIN student s ON e.studentID=s.id
        LEFT JOIN building b ON s.buildingID=b.id
        LEFT JOIN room r ON s.roomID=r.id
        where e.state=1
        <if test="phone!=''">
            and s.phone=#{phone}
        </if>
        <if test="arriveTime!=null">
            and Date(e.arriveTime)=#{arriveTime}
        </if>
        <if test="buildingName!=''">
            and b.name=#{buildingName}
        </if>
        <if test="type!=''">
            and e.type=#{type}
        </if>
    </select>
    <select id="centerSearch" resultType="Express" parameterType="Express">
        select id,code,type,tip,arriveTime,time from  express
        where studentID=#{studentID}
        <if test="arriveTime!=null">
            and Date(express.arriveTime)=#{arriveTime}
        </if>
        <if test="type!=''">
            and express.type=#{type}
        </if>
        <if test="value==false">
            and express.state=0
        </if>
        <if test="value==true">
            and express.state=1
        </if>
    </select>
</mapper>
